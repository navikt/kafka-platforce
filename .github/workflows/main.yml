name: Preconfigured run on push

on: [push, pull_request] #[push, pull_request]

jobs:
  build-deploy:
    uses: ./.github/workflows/workflow.yml
    permissions:
      id-token: write
      contents: write
    secrets: inherit
    with:
      DEPLOY_APP: sf-pdl-kafka # sf-geografisktilknytning
      DEPLOY_CLUSTER: dev-gcp

      # Start consuming from a particular offset
      FLAG_SEEK: true

      # If flag seek is set, where to go. Will seek to next that exists on queue. '0' equals 'from beginning'
      SEEK_OFFSET: '20777320' # - save some time for test case

      # How many samples should be stored. Will sample first ones that passes filter.
      NUMBER_OF_SAMPLES: '5'

      # Do not post any records to salesforce - dry run
      FLAG_NO_POST: true

      # Run one work session - ie when no more records found - stop polling for more during lifetime of app
      FLAG_RUN_ONCE: true

      # Add -alt postfix to client id - look like an alter ego to kafka cluster. Useful for doing an operation
      # and then switching back to return to previous position.
      FLAG_ALT_ID: false